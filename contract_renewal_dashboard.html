<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‘ç´„æ›´æ–°ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title> <!-- ã‚¿ã‚¤ãƒˆãƒ«ã‚‚å¤‰æ›´ -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            background-color: #f4f7f9;
            color: #333;
            font-size: 14px;
        }

        .dashboard-container {
            padding: 20px;
            max-width: 100%;
        }

        .dashboard-header {
            margin-bottom: 20px;
            padding-bottom: 15px; /* äº‹æ¥­æ‰€åè¡¨ç¤ºã‚¨ãƒªã‚¢ã¨ã®åŒºåˆ‡ã‚Š */
            border-bottom: 1px solid #e0e0e0; /* åŒºåˆ‡ã‚Šç·š */
        }

        .dashboard-header h1 {
            font-size: 24px;
            margin-top: 0; /* ä¸Šãƒãƒ¼ã‚¸ãƒ³èª¿æ•´ */
            margin-bottom: 8px; /* ä¸‹ãƒãƒ¼ã‚¸ãƒ³èª¿æ•´ */
            color: #2c3e50;
        }

        .office-info { /* æ–°ã—ãè¿½åŠ ã™ã‚‹äº‹æ¥­æ‰€æƒ…å ±ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
            font-size: 16px;
            color: #555;
            margin-bottom: 15px;
        }
        .office-info strong {
            font-weight: 600;
            color: #333;
        }


        .actions-filter-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background-color: #fff;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .actions-filter-bar .filter-group,
        .actions-filter-bar .action-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .actions-filter-bar input[type="text"],
        .actions-filter-bar select {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }
        .actions-filter-bar input[type="text"]::placeholder {
            color: #aaa;
        }


        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s ease;
        }

        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: #7f8c8d;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #6c7a89;
        }

        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        .btn-success:hover {
            background-color: #27ae60;
        }

        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }
        .btn-danger:hover {
            background-color: #c0392b;
        }

        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            background-color: #fff;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .dashboard-table {
            width: 100%;
            min-width: 3000px; 
            border-collapse: collapse;
            white-space: nowrap;
        }

        .dashboard-table th,
        .dashboard-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: middle;
        }

        .dashboard-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #555;
            white-space: nowrap;
        }
        .dashboard-table thead th {
            position: sticky;
            top: 0;
            z-index: 1;
        }
        .dashboard-table thead th:first-child {
            position: sticky;
            left: 0;
            z-index: 2;
            background-color: #f8f9fa;
        }
         .dashboard-table tbody td:first-child {
            position: sticky;
            left: 0;
            z-index: 0;
            background-color: #fff; 
        }
        .dashboard-table td[contenteditable="true"] {
            background-color: #f0f8ff; 
            cursor: text;
        }
        .dashboard-table td.highlight-changed {
            background-color: #fffacd !important; 
            font-weight: bold;
            outline: 1px dashed #f39c12; 
        }


        .dashboard-table tbody tr:hover {
            background-color: #f1f3f5;
        }

        .status-label {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
            color: white;
            min-width: 80px;
            text-align: center;
        }

        .status-managing { background-color: #3498db; }
        .status-pending { background-color: #1abc9c; }
        .status-member-support { background-color: #f1c40f; color:#333; }
        .status-rejected { background-color: #e74c3c; }
        .status-completed { background-color: #2ecc71; }
        .status-default { background-color: #95a5a6; }

        .dashboard-table input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .remarks-icon { 
            color: #7f8c8d;
            cursor: pointer;
        }
         .delay-flag-true {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .confirmation-area {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9f5ff;
            border: 1px solid #b3d7ff;
            border-radius: 6px;
            text-align: right;
        }
        .confirmation-area p {
            margin: 0 0 10px 0;
            font-size: 15px;
            color: #2c3e50;
        }

    </style>
</head>
<body>
    <div class="dashboard-container">
        <header class="dashboard-header">
            <h1>å¥‘ç´„æ›´æ–°ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
            <div class="office-info">
                <p>
                    <strong>äº‹æ¥­æ‰€:</strong> é¦–éƒ½åœBIç¬¬äºŒäº‹æ¥­æœ¬éƒ¨ã€€æ±äº¬BIç¬¬4äº‹æ¥­éƒ¨<br>
                    <strong>äº‹æ¥­éƒ¨é•·:</strong> æœ¨æ‘æµ©ä¸€éƒ
                </p>
            </div>
            <!-- ä¸è¦ãªæ–‡è¨€ã¯å‰Šé™¤ã—ã¾ã—ãŸ -->
        </header>

        <div class="actions-filter-bar">
            <div class="filter-group">
                <input type="text" id="employeeFilter" placeholder="å¾“æ¥­å“¡ã§çµã‚Šè¾¼ã‚€">
                <button class="btn btn-danger" id="deleteSelectedBtn">ãƒã‚§ãƒƒã‚¯ã—ãŸä¾é ¼ã‚’å‰Šé™¤ã™ã‚‹</button>
                <button class="btn btn-secondary" id="resetToDefaultBtn">é¸æŠã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«æˆ»ã™</button>
            </div>
            <div class="filter-group">
                <select id="statusFilter">
                    <option value="incomplete">æ‰‹ç¶šã®çŠ¶æ³ æœªå®Œäº†</option>
                    <option value="all">æ‰‹ç¶šã®çŠ¶æ³ å…¨ã¦</option>
                    <option value="complete">æ‰‹ç¶šã®çŠ¶æ³ å®Œäº†</option>
                </select>
                <select id="dateFilterType">
                    <option value="request_date">ä¾é ¼æ—¥</option>
                    <option value="due_date">æå‡ºæœŸé™</option>
                </select>
            </div>
        </div>

        <div class="table-wrapper">
            <table class="dashboard-table" id="dashboardTable">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="selectAllCheckbox" title="ã™ã¹ã¦é¸æŠ"></th>
                        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                        <th>é€ä»˜æ—¥</th>
                        <th>é–‹å°æ—¥</th>
                        <th>åŒæ„</th>
                        <th>åŒæ„æ—¥</th>
                        <th>äº‹æ¥­æ‰€å</th>
                        <th>å¾“æ¥­å“¡ç•ªå·</th>
                        <th>å¾“æ¥­å“¡å</th>
                        <th>é›‡ç”¨å½¢æ…‹</th>
                        <th>å¥‘ç´„é–‹å§‹æ—¥</th>
                        <th>å¥‘ç´„çµ‚äº†æ—¥</th>
                        <th>æ™‚çµ¦</th>
                        <th>è²¬ä»»è€…æ‰‹å½“</th>
                        <th>è³ä¸å¹´é–“ (æœˆæ•°)</th>
                        <th>å¥‘ç´„æ™‚é–“æ•°ï¼ˆ1æ—¥ï¼‰</th>
                        <th>å¥‘ç´„æ—¥æ•°ï¼ˆæœˆé–“ï¼‰</th>
                        <th>ã‚·ãƒ•ãƒˆ1</th>
                        <th>ã‚·ãƒ•ãƒˆ1ä¼‘æ†©(åˆ†)</th>
                        <th>ã‚·ãƒ•ãƒˆ2</th>
                        <th>ã‚·ãƒ•ãƒˆ2ä¼‘æ†©(åˆ†)</th>
                        <th>ç¬¬2åŠ ç®—æ™‚çµ¦</th>
                        <th>ç¬¬3åŠ ç®—æ™‚çµ¦</th>
                        <th>ç¬¬4åŠ ç®—æ™‚çµ¦</th>
                        <th>ãã®ä»–æ‰‹å½“1</th>
                        <th>ãã®ä»–æ‰‹å½“2</th>
                        <th>ç¤¾ä¼šä¿é™ºåŠ å…¥</th>
                        <th>é›‡ç”¨ä¿é™ºåŠ å…¥</th>
                        <th>ãƒªãƒã‚¤ãƒ³ãƒ‰æ—¥</th>
                        <th>æå‡ºæœŸé™</th>
                        <th>é…å»¶ãƒ•ãƒ©ã‚°</th>
                        <th>å‚™è€ƒ</th>
                    </tr>
                </thead>
                <tbody id="dashboardTableBody">
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 1 -->
                    <tr data-record-id="1">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="ç®¡ç†ä¸­"><span class="status-label status-managing">ç®¡ç†ä¸­</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/03/15">2025/03/15</td>
                        <td data-column-name="open_date" data-initial-value="2025/03/16">2025/03/16</td>
                        <td data-column-name="agreement" data-initial-value="æ¸ˆ">æ¸ˆ</td>
                        <td data-column-name="agreement_date" data-initial-value="2025/03/17">2025/03/17</td>
                        <td data-column-name="office_name" data-initial-value="æœ¬ç¤¾ ç¬¬ä¸€äº‹æ¥­éƒ¨" contenteditable="true">æœ¬ç¤¾ ç¬¬ä¸€äº‹æ¥­éƒ¨</td>
                        <td data-column-name="employee_id" data-initial-value="301001">301001</td>
                        <td data-column-name="employee_name" data-initial-value="å¾“æ¥­å“¡ ã‚¿ãƒ­ã‚¦">å¾“æ¥­å“¡ ã‚¿ãƒ­ã‚¦</td>
                        <td data-column-name="employment_type" data-initial-value="æ­£ç¤¾å“¡" contenteditable="true">æ­£ç¤¾å“¡</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/04/01" contenteditable="true">2025/04/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="hourly_wage" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="manager_allowance" data-initial-value="50000" contenteditable="true">50,000</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="2.0" contenteditable="true">2.0ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="8.0" contenteditable="true">8.0</td>
                        <td data-column-name="contract_days_month" data-initial-value="20" contenteditable="true">20</td>
                        <td data-column-name="shift1" data-initial-value="9:00-18:00" contenteditable="true">9:00-18:00</td>
                        <td data-column-name="shift1_break" data-initial-value="60" contenteditable="true">60</td>
                        <td data-column-name="shift2" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="shift2_break" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="10000" contenteditable="true">10,000</td>
                        <td data-column-name="other_allowance2" data-initial-value="5000" contenteditable="true">5,000</td>
                        <td data-column-name="social_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="2025/03/25">2025/03/25</td>
                        <td data-column-name="due_date" data-initial-value="2025/03/31">2025/03/31</td>
                        <td data-column-name="delay_flag" data-initial-value="ãªã—"><span class="delay-flag-false">ãªã—</span></td>
                        <td data-column-name="remarks" data-initial-value="æ‰‹ç¶šãè©³ç´°ã‚’ç¢ºèª" contenteditable="true">æ‰‹ç¶šãè©³ç´°ã‚’ç¢ºèª</td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 2 -->
                    <tr data-record-id="2">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="æœªç€æ‰‹"><span class="status-label status-default">æœªç€æ‰‹</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/02/10">2025/02/10</td>
                        <td data-column-name="open_date" data-initial-value="-">-</td>
                        <td data-column-name="agreement" data-initial-value="æœª">æœª</td>
                        <td data-column-name="agreement_date" data-initial-value="-">-</td>
                        <td data-column-name="office_name" data-initial-value="å¤§é˜ªæ”¯ç¤¾" contenteditable="true">å¤§é˜ªæ”¯ç¤¾</td>
                        <td data-column-name="employee_id" data-initial-value="002031">002031</td>
                        <td data-column-name="employee_name" data-initial-value="è‘‰æœˆ å®ŸèŠ±">è‘‰æœˆ å®ŸèŠ±</td>
                        <td data-column-name="employment_type" data-initial-value="å¥‘ç´„ç¤¾å“¡" contenteditable="true">å¥‘ç´„ç¤¾å“¡</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/03/01" contenteditable="true">2025/03/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="2026/02/28" contenteditable="true">2026/02/28</td>
                        <td data-column-name="hourly_wage" data-initial-value="1500" contenteditable="true">1,500</td>
                        <td data-column-name="manager_allowance" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="0" contenteditable="true">0ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="7.5" contenteditable="true">7.5</td>
                        <td data-column-name="contract_days_month" data-initial-value="18" contenteditable="true">18</td>
                        <td data-column-name="shift1" data-initial-value="10:00-18:30" contenteditable="true">10:00-18:30</td>
                        <td data-column-name="shift1_break" data-initial-value="45" contenteditable="true">45</td>
                        <td data-column-name="shift2" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="shift2_break" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="other_allowance2" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="social_insurance" data-initial-value="æœªåŠ å…¥">æœªåŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="2025/02/20">2025/02/20</td>
                        <td data-column-name="due_date" data-initial-value="2025/02/28">2025/02/28</td>
                        <td data-column-name="delay_flag" data-initial-value="ãªã—"><span class="delay-flag-false">ãªã—</span></td>
                        <td data-column-name="remarks" data-initial-value="SmartHR æœªåˆæ„" contenteditable="true">SmartHR å…¥åŠ›ä¸è¦ãƒ•ã‚©ãƒ¼ãƒ  æœªåˆæ„</td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 3 -->
                    <tr data-record-id="3">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="ç¢ºèªä¸­"><span class="status-label status-pending">ç¢ºèªä¸­</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/04/01">2025/04/01</td>
                        <td data-column-name="open_date" data-initial-value="2025/04/02">2025/04/02</td>
                        <td data-column-name="agreement" data-initial-value="æ¸ˆ">æ¸ˆ</td>
                        <td data-column-name="agreement_date" data-initial-value="2025/04/02">2025/04/02</td>
                        <td data-column-name="office_name" data-initial-value="æ±äº¬ã‚µãƒ†ãƒ©ã‚¤ãƒˆ" contenteditable="true">æ±äº¬ã‚µãƒ†ãƒ©ã‚¤ãƒˆ</td>
                        <td data-column-name="employee_id" data-initial-value="300202">300202</td>
                        <td data-column-name="employee_name" data-initial-value="æ–‡æœˆ èª å­">æ–‡æœˆ èª å­</td>
                        <td data-column-name="employment_type" data-initial-value="åœ°åŸŸæ­£ç¤¾å“¡" contenteditable="true">åœ°åŸŸæ­£ç¤¾å“¡</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/05/01" contenteditable="true">2025/05/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="hourly_wage" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="manager_allowance" data-initial-value="30000" contenteditable="true">30,000</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="1.5" contenteditable="true">1.5ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="8.0" contenteditable="true">8.0</td>
                        <td data-column-name="contract_days_month" data-initial-value="21" contenteditable="true">21</td>
                        <td data-column-name="shift1" data-initial-value="9:30-18:30" contenteditable="true">9:30-18:30</td>
                        <td data-column-name="shift1_break" data-initial-value="60" contenteditable="true">60</td>
                        <td data-column-name="shift2" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="shift2_break" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="8000" contenteditable="true">8,000</td>
                        <td data-column-name="other_allowance2" data-initial-value="3000" contenteditable="true">3,000</td>
                        <td data-column-name="social_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="2025/04/15">2025/04/15</td>
                        <td data-column-name="due_date" data-initial-value="2025/04/20">2025/04/20</td>
                        <td data-column-name="delay_flag" data-initial-value="ãªã—"><span class="delay-flag-false">ãªã—</span></td>
                        <td data-column-name="remarks" data-initial-value="æå‡ºå†…å®¹ã‚’ç¢ºèª" contenteditable="true">æå‡ºå†…å®¹ã‚’ç¢ºèª <span class="remarks-icon">ğŸ’¬</span></td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 4 -->
                    <tr data-record-id="4">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="ãƒ¡ãƒ³ãƒãƒ¼å¯¾å¿œä¸­"><span class="status-label status-member-support">ãƒ¡ãƒ³ãƒãƒ¼å¯¾å¿œä¸­</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/05/02">2025/05/02</td>
                        <td data-column-name="open_date" data-initial-value="2025/05/03">2025/05/03</td>
                        <td data-column-name="agreement" data-initial-value="æœª">æœª</td>
                        <td data-column-name="agreement_date" data-initial-value="-">-</td>
                        <td data-column-name="office_name" data-initial-value="ç¦å²¡å–¶æ¥­æ‰€" contenteditable="true">ç¦å²¡å–¶æ¥­æ‰€</td>
                        <td data-column-name="employee_id" data-initial-value="040500">040500</td>
                        <td data-column-name="employee_name" data-initial-value="ç¥ç„¡æœˆ å…‰">ç¥ç„¡æœˆ å…‰</td>
                        <td data-column-name="employment_type" data-initial-value="å¥‘ç´„ç¤¾å“¡107" contenteditable="true">å¥‘ç´„ç¤¾å“¡107</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/06/01" contenteditable="true">2025/06/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="2025/11/30" contenteditable="true">2025/11/30</td>
                        <td data-column-name="hourly_wage" data-initial-value="1800" contenteditable="true">1,800</td>
                        <td data-column-name="manager_allowance" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="0.5" contenteditable="true">0.5ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="6.0" contenteditable="true">6.0</td>
                        <td data-column-name="contract_days_month" data-initial-value="15" contenteditable="true">15</td>
                        <td data-column-name="shift1" data-initial-value="10:00-17:00" contenteditable="true">10:00-17:00</td>
                        <td data-column-name="shift1_break" data-initial-value="60" contenteditable="true">60</td>
                        <td data-column-name="shift2" data-initial-value="13:00-20:00" contenteditable="true">13:00-20:00</td>
                        <td data-column-name="shift2_break" data-initial-value="60" contenteditable="true">60</td>
                        <td data-column-name="additional_wage2" data-initial-value="200">200</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="other_allowance2" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="social_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="2025/05/15">2025/05/15</td>
                        <td data-column-name="due_date" data-initial-value="2025/05/20">2025/05/20</td>
                        <td data-column-name="delay_flag" data-initial-value="ãªã—"><span class="delay-flag-false">ãªã—</span></td>
                        <td data-column-name="remarks" data-initial-value="å¾“æ¥­å“¡ãŒå…¥åŠ›å†…å®¹ã‚’ç¢ºèªä¸­..." contenteditable="true">å¾“æ¥­å“¡ãŒå…¥åŠ›å†…å®¹ã‚’ç¢ºèªä¸­...</td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 5 -->
                     <tr data-record-id="5">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="ä¿®æ­£ä¾é ¼ä¸­"><span class="status-label status-rejected">ä¿®æ­£ä¾é ¼ä¸­</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/03/20">2025/03/20</td>
                        <td data-column-name="open_date" data-initial-value="2025/03/21">2025/03/21</td>
                        <td data-column-name="agreement" data-initial-value="ä¸€éƒ¨æ¸ˆ">ä¸€éƒ¨æ¸ˆ</td>
                        <td data-column-name="agreement_date" data-initial-value="2025/03/22">2025/03/22</td>
                        <td data-column-name="office_name" data-initial-value="æœ­å¹Œæ”¯åº—" contenteditable="true">æœ­å¹Œæ”¯åº—</td>
                        <td data-column-name="employee_id" data-initial-value="311501">311501</td>
                        <td data-column-name="employee_name" data-initial-value="é•·æœˆ å¥">é•·æœˆ å¥</td>
                        <td data-column-name="employment_type" data-initial-value="ã‚µãƒ—ãƒ©ãƒ¼" contenteditable="true">ã‚µãƒ—ãƒ©ãƒ¼</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/04/10" contenteditable="true">2025/04/10</td>
                        <td data-column-name="contract_end_date" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="hourly_wage" data-initial-value="1200" contenteditable="true">1,200</td>
                        <td data-column-name="manager_allowance" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="0" contenteditable="true">0ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="4.0" contenteditable="true">4.0</td>
                        <td data-column-name="contract_days_month" data-initial-value="10" contenteditable="true">10</td>
                        <td data-column-name="shift1" data-initial-value="9:00-13:00" contenteditable="true">9:00-13:00</td>
                        <td data-column-name="shift1_break" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="shift2" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="shift2_break" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="other_allowance2" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="social_insurance" data-initial-value="æœªåŠ å…¥">æœªåŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="æœªåŠ å…¥">æœªåŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="2025/04/01">2025/04/01</td>
                        <td data-column-name="due_date" data-initial-value="2025/04/05">2025/04/05</td>
                        <td data-column-name="delay_flag" data-initial-value="ã‚ã‚Š"><span class="delay-flag-true">ã‚ã‚Š</span></td>
                        <td data-column-name="remarks" data-initial-value="ç®¡ç†è€…ãŒä¿®æ­£ä¾é ¼é€ä¿¡æ¸ˆã¿" contenteditable="true">ç®¡ç†è€…ãŒä¿®æ­£ä¾é ¼é€ä¿¡æ¸ˆã¿</td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 6 -->
                    <tr data-record-id="6">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="å®Œäº†æ¸ˆã¿"><span class="status-label status-completed">å®Œäº†æ¸ˆã¿</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/02/05">2025/02/05</td>
                        <td data-column-name="open_date" data-initial-value="2025/02/06">2025/02/06</td>
                        <td data-column-name="agreement" data-initial-value="æ¸ˆ">æ¸ˆ</td>
                        <td data-column-name="agreement_date" data-initial-value="2025/02/07">2025/02/07</td>
                        <td data-column-name="office_name" data-initial-value="ç®¡ç†æœ¬éƒ¨" contenteditable="true">ç®¡ç†æœ¬éƒ¨</td>
                        <td data-column-name="employee_id" data-initial-value="011011">011011</td>
                        <td data-column-name="employee_name" data-initial-value="ç®¡ç† å¤ªéƒ">ç®¡ç† å¤ªéƒ</td>
                        <td data-column-name="employment_type" data-initial-value="æ­£ç¤¾å“¡" contenteditable="true">æ­£ç¤¾å“¡</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/03/01" contenteditable="true">2025/03/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="hourly_wage" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="manager_allowance" data-initial-value="80000" contenteditable="true">80,000</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="4.0" contenteditable="true">4.0ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="8.0" contenteditable="true">8.0</td>
                        <td data-column-name="contract_days_month" data-initial-value="22" contenteditable="true">22</td>
                        <td data-column-name="shift1" data-initial-value="9:00-18:00" contenteditable="true">9:00-18:00</td>
                        <td data-column-name="shift1_break" data-initial-value="60" contenteditable="true">60</td>
                        <td data-column-name="shift2" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="shift2_break" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="15000" contenteditable="true">15,000</td>
                        <td data-column-name="other_allowance2" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="social_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="-">-</td>
                        <td data-column-name="due_date" data-initial-value="2025/02/15">2025/02/15</td>
                        <td data-column-name="delay_flag" data-initial-value="ãªã—"><span class="delay-flag-false">ãªã—</span></td>
                        <td data-column-name="remarks" data-initial-value="å…¨ã¦ã®æ‰‹ç¶šããŒå®Œäº†" contenteditable="true">å…¨ã¦ã®æ‰‹ç¶šããŒå®Œäº†</td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 7 -->
                    <tr data-record-id="7">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="ç®¡ç†ä¸­"><span class="status-label status-managing">ç®¡ç†ä¸­</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/06/01">2025/06/01</td>
                        <td data-column-name="open_date" data-initial-value="-">-</td>
                        <td data-column-name="agreement" data-initial-value="æœª">æœª</td>
                        <td data-column-name="agreement_date" data-initial-value="-">-</td>
                        <td data-column-name="office_name" data-initial-value="åå¤å±‹ã‚ªãƒ•ã‚£ã‚¹" contenteditable="true">åå¤å±‹ã‚ªãƒ•ã‚£ã‚¹</td>
                        <td data-column-name="employee_id" data-initial-value="350100">350100</td>
                        <td data-column-name="employee_name" data-initial-value="æ±æµ· æ—æª">æ±æµ· æ—æª</td>
                        <td data-column-name="employment_type" data-initial-value="å¥‘ç´„ç¤¾å“¡" contenteditable="true">å¥‘ç´„ç¤¾å“¡</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/07/01" contenteditable="true">2025/07/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="2026/06/30" contenteditable="true">2026/06/30</td>
                        <td data-column-name="hourly_wage" data-initial-value="1600" contenteditable="true">1,600</td>
                        <td data-column-name="manager_allowance" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="1.0" contenteditable="true">1.0ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="7.0" contenteditable="true">7.0</td>
                        <td data-column-name="contract_days_month" data-initial-value="16" contenteditable="true">16</td>
                        <td data-column-name="shift1" data-initial-value="9:00-17:00" contenteditable="true">9:00-17:00</td>
                        <td data-column-name="shift1_break" data-initial-value="60" contenteditable="true">60</td>
                        <td data-column-name="shift2" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="shift2_break" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="7000" contenteditable="true">7,000</td>
                        <td data-column-name="other_allowance2" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="social_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="2025/06/15">2025/06/15</td>
                        <td data-column-name="due_date" data-initial-value="2025/06/20">2025/06/20</td>
                        <td data-column-name="delay_flag" data-initial-value="ãªã—"><span class="delay-flag-false">ãªã—</span></td>
                        <td data-column-name="remarks" data-initial-value="æ–°è¦æ¡ç”¨" contenteditable="true">æ–°è¦æ¡ç”¨</td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 8 -->
                    <tr data-record-id="8">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="ç¢ºèªä¸­"><span class="status-label status-pending">ç¢ºèªä¸­</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/07/10">2025/07/10</td>
                        <td data-column-name="open_date" data-initial-value="2025/07/11">2025/07/11</td>
                        <td data-column-name="agreement" data-initial-value="æ¸ˆ">æ¸ˆ</td>
                        <td data-column-name="agreement_date" data-initial-value="2025/07/11">2025/07/11</td>
                        <td data-column-name="office_name" data-initial-value="æ²–ç¸„ãƒ–ãƒ©ãƒ³ãƒ" contenteditable="true">æ²–ç¸„ãƒ–ãƒ©ãƒ³ãƒ</td>
                        <td data-column-name="employee_id" data-initial-value="050201">050201</td>
                        <td data-column-name="employee_name" data-initial-value="å³¶è¢‹ èŠ±å­">å³¶è¢‹ èŠ±å­</td>
                        <td data-column-name="employment_type" data-initial-value="åœ°åŸŸæ­£ç¤¾å“¡" contenteditable="true">åœ°åŸŸæ­£ç¤¾å“¡</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/08/01" contenteditable="true">2025/08/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="hourly_wage" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="manager_allowance" data-initial-value="20000" contenteditable="true">20,000</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="1.0" contenteditable="true">1.0ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="7.5" contenteditable="true">7.5</td>
                        <td data-column-name="contract_days_month" data-initial-value="20" contenteditable="true">20</td>
                        <td data-column-name="shift1" data-initial-value="8:30-17:00" contenteditable="true">8:30-17:00</td>
                        <td data-column-name="shift1_break" data-initial-value="60" contenteditable="true">60</td>
                        <td data-column-name="shift2" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="shift2_break" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="5000" contenteditable="true">5,000</td>
                        <td data-column-name="other_allowance2" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="social_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="2025/07/20">2025/07/20</td>
                        <td data-column-name="due_date" data-initial-value="2025/07/25">2025/07/25</td>
                        <td data-column-name="delay_flag" data-initial-value="ãªã—"><span class="delay-flag-false">ãªã—</span></td>
                        <td data-column-name="remarks" data-initial-value="æ›¸é¡ç¢ºèªä¸­" contenteditable="true">æ›¸é¡ç¢ºèªä¸­</td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 9 -->
                    <tr data-record-id="9">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="å®Œäº†æ¸ˆã¿"><span class="status-label status-completed">å®Œäº†æ¸ˆã¿</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/01/15">2025/01/15</td>
                        <td data-column-name="open_date" data-initial-value="2025/01/16">2025/01/16</td>
                        <td data-column-name="agreement" data-initial-value="æ¸ˆ">æ¸ˆ</td>
                        <td data-column-name="agreement_date" data-initial-value="2025/01/17">2025/01/17</td>
                        <td data-column-name="office_name" data-initial-value="åºƒå³¶æ”¯åº—" contenteditable="true">åºƒå³¶æ”¯åº—</td>
                        <td data-column-name="employee_id" data-initial-value="720300">720300</td>
                        <td data-column-name="employee_name" data-initial-value="ç€¬æˆ¸ æ¥“">ç€¬æˆ¸ æ¥“</td>
                        <td data-column-name="employment_type" data-initial-value="å¥‘ç´„ç¤¾å“¡107" contenteditable="true">å¥‘ç´„ç¤¾å“¡107</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/02/01" contenteditable="true">2025/02/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="2025/07/31" contenteditable="true">2025/07/31</td>
                        <td data-column-name="hourly_wage" data-initial-value="1300" contenteditable="true">1,300</td>
                        <td data-column-name="manager_allowance" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="0" contenteditable="true">0ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="5.0" contenteditable="true">5.0</td>
                        <td data-column-name="contract_days_month" data-initial-value="12" contenteditable="true">12</td>
                        <td data-column-name="shift1" data-initial-value="10:00-15:00" contenteditable="true">10:00-15:00</td>
                        <td data-column-name="shift1_break" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="shift2" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="shift2_break" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="other_allowance2" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="social_insurance" data-initial-value="æœªåŠ å…¥">æœªåŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="æœªåŠ å…¥">æœªåŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="-">-</td>
                        <td data-column-name="due_date" data-initial-value="2025/01/25">2025/01/25</td>
                        <td data-column-name="delay_flag" data-initial-value="ãªã—"><span class="delay-flag-false">ãªã—</span></td>
                        <td data-column-name="remarks" data-initial-value="çŸ­æœŸé–“å¥‘ç´„" contenteditable="true">çŸ­æœŸé–“å¥‘ç´„</td>
                    </tr>
                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚³ãƒ¼ãƒ‰ 10 -->
                    <tr data-record-id="10">
                        <td><input type="checkbox" class="row-checkbox"></td>
                        <td data-column-name="status" data-initial-value="ä¿®æ­£ä¾é ¼ä¸­"><span class="status-label status-rejected">ä¿®æ­£ä¾é ¼ä¸­</span></td>
                        <td data-column-name="send_date" data-initial-value="2025/08/01">2025/08/01</td>
                        <td data-column-name="open_date" data-initial-value="2025/08/02">2025/08/02</td>
                        <td data-column-name="agreement" data-initial-value="ä¸€éƒ¨æœª">ä¸€éƒ¨æœª</td>
                        <td data-column-name="agreement_date" data-initial-value="-">-</td>
                        <td data-column-name="office_name" data-initial-value="ä»™å°æ”¯ç¤¾" contenteditable="true">ä»™å°æ”¯ç¤¾</td>
                        <td data-column-name="employee_id" data-initial-value="123456">123456</td>
                        <td data-column-name="employee_name" data-initial-value="ä¼Šé” æ”¿å®—">ä¼Šé” æ”¿å®—</td>
                        <td data-column-name="employment_type" data-initial-value="ã‚µãƒ—ãƒ©ãƒ¼" contenteditable="true">ã‚µãƒ—ãƒ©ãƒ¼</td>
                        <td data-column-name="contract_start_date" data-initial-value="2025/09/01" contenteditable="true">2025/09/01</td>
                        <td data-column-name="contract_end_date" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="hourly_wage" data-initial-value="1100" contenteditable="true">1,100</td>
                        <td data-column-name="manager_allowance" data-initial-value="-" contenteditable="true">-</td>
                        <td data-column-name="annual_bonus_months" data-initial-value="0" contenteditable="true">0ãƒ¶æœˆ</td>
                        <td data-column-name="contract_hours_day" data-initial-value="6.0" contenteditable="true">6.0</td>
                        <td data-column-name="contract_days_month" data-initial-value="15" contenteditable="true">15</td>
                        <td data-column-name="shift1" data-initial-value="9:00-15:00" contenteditable="true">9:00-15:00</td>
                        <td data-column-name="shift1_break" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="shift2" data-initial-value="13:00-19:00" contenteditable="true">13:00-19:00</td>
                        <td data-column-name="shift2_break" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="additional_wage2" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage3" data-initial-value="-">-</td>
                        <td data-column-name="additional_wage4" data-initial-value="-">-</td>
                        <td data-column-name="other_allowance1" data-initial-value="3000" contenteditable="true">3,000</td>
                        <td data-column-name="other_allowance2" data-initial-value="0" contenteditable="true">0</td>
                        <td data-column-name="social_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="employment_insurance" data-initial-value="åŠ å…¥">åŠ å…¥</td>
                        <td data-column-name="reminder_date" data-initial-value="2025/08/15">2025/08/15</td>
                        <td data-column-name="due_date" data-initial-value="2025/08/20">2025/08/20</td>
                        <td data-column-name="delay_flag" data-initial-value="ã‚ã‚Š"><span class="delay-flag-true">ã‚ã‚Š</span></td>
                        <td data-column-name="remarks" data-initial-value="åŒæ„æ›¸å†æå‡ºä¾é ¼" contenteditable="true">åŒæ„æ›¸å†æå‡ºä¾é ¼</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="confirmation-area">
            <p><span id="changedRecordCount">0</span>ä»¶ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›´ãŒã‚ã‚Šã¾ã™ã€‚</p>
            <button class="btn btn-success" id="confirmAndUpdateBtn">å¤‰æ›´ã‚’ç¢ºå®šã—äººäº‹ãƒã‚¹ã‚¿ã‚’æ›´æ–°</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tableBody = document.getElementById('dashboardTableBody');

            if (tableBody) {
                tableBody.addEventListener('blur', function(event) {
                    const cell = event.target;
                    if (cell.tagName === 'TD' && cell.isContentEditable) {
                        const initialValue = cell.dataset.initialValue || '';
                        const currentValue = cell.textContent.trim();

                        if (initialValue !== currentValue) {
                            cell.classList.add('highlight-changed');
                        } else {
                            cell.classList.remove('highlight-changed');
                        }
                        updateChangedRecordCount();
                    }
                }, true);
            }


            function updateChangedRecordCount() {
                if (!tableBody) return;
                const changedCells = tableBody.querySelectorAll('td.highlight-changed');
                const changedRecordIds = new Set();
                changedCells.forEach(cell => {
                    const row = cell.closest('tr');
                    if (row && row.dataset.recordId) {
                        changedRecordIds.add(row.dataset.recordId);
                    }
                });
                const countElement = document.getElementById('changedRecordCount');
                if (countElement) {
                     countElement.textContent = changedRecordIds.size;
                }
            }

            const resetBtn = document.getElementById('resetToDefaultBtn');
            if (resetBtn && tableBody) {
                resetBtn.addEventListener('click', function() {
                    const selectedRows = tableBody.querySelectorAll('tr input.row-checkbox:checked');
                    selectedRows.forEach(checkbox => {
                        const row = checkbox.closest('tr');
                        if (row) {
                            const editableCells = row.querySelectorAll('td[contenteditable="true"]');
                            editableCells.forEach(cell => {
                                cell.textContent = cell.dataset.initialValue || '';
                                cell.classList.remove('highlight-changed');
                            });
                        }
                    });
                    updateChangedRecordCount();
                });
            }
            
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            if (selectAllCheckbox && tableBody) {
                selectAllCheckbox.addEventListener('change', function() {
                    const rowCheckboxes = tableBody.querySelectorAll('input.row-checkbox');
                    rowCheckboxes.forEach(checkbox => {
                        checkbox.checked = selectAllCheckbox.checked;
                    });
                });
            }
            updateChangedRecordCount(); 
        });
    </script>
</body>
</html>