<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>労働条件通知書 兼 雇用契約書</title>
    <style>
        /* Styles from original employment_terms_contract.html */
        body {
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
            color: #333;
            font-size: 14px; /* Base font size from renewal_contract_format */
            line-height: 1.6;   /* Base line height from renewal_contract_format */
        }
        .page-header {
            background-color: #fff;
            padding: 15px 30px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .breadcrumb {
            font-size: 13px;
            color: #555;
        }
        .logout-button {
            font-size: 13px;
            padding: 8px 15px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
        }
        .debug-controls {
            background-color: #ffe0b2;
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #ffcc80;
        }
        .debug-controls button {
            background-color: #ff9800;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .debug-controls button:hover {
            background-color: #f57c00;
        }

        .main-content {
            padding: 30px;
            max-width: 900px; /* Original max-width for overall page layout */
            margin: 20px auto;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .page-title-container {
            margin-bottom: 20px;
        }

        .title-and-actions-row {
            display: flex;
            justify-content: space-between; 
            align-items: center; 
            width: 100%; 
        }
        
        .page-main-title-wrapper { 
             display: flex;
             align-items: center;
             gap: 15px; 
             flex-grow: 1; 
             justify-content: center; 
        }

        .main-content h1 { 
            font-size: 22px;
            color: #1c1e21;
            margin-top: 0;
            margin-bottom: 0;
            white-space: nowrap; 
        }
        
        #agreement-status-indicator {
            font-size: 2em; 
            color: red;
            font-weight: bold;
            white-space: nowrap;
            display: none; 
        }
        
        .post-agreement-actions {
            display: none; 
            flex-direction: column; 
            align-items: flex-end; 
            gap: 8px; 
            flex-shrink: 0; 
        }

        .action-buttons-row-inner { 
            display: flex;
            gap: 10px; 
        }

        .post-agreement-actions .action-btn-small {
            padding: 8px 15px;
            font-size: 14px;
            border: 1px solid #ccc;
            background-color: #fff;
            color: #333;
            border-radius: 4px;
            cursor: pointer;
            margin: 0; 
            display: inline-flex; 
            align-items: center;
            gap: 5px; 
            width: 130px; 
            justify-content: center; 
        }


        .post-agreement-note-standalone {
            display: none;
            text-align: right; 
            font-size: 12px;
            color: #666;
            margin-top: 10px; 
        }

        .info-banner {
            background-color: #007bff;
            color: white;
            padding: 15px 20px;
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 25px;
        }
        .contract-viewer { 
            border: 1px solid #ccc;
            border-radius: 6px;
            padding: 20px; 
            margin-bottom: 25px;
            background-color: #fff;
            overflow-x: auto;
        }
        
        .action-prompt { 
            text-align: center;
            font-size: 14px;
            color: #555;
            margin-bottom: 20px;
        }
        .button-group { 
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .action-btn {
            padding: 10px 25px;
            font-size: 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        .agree-btn {
            background-color: #007bff;
            color: white;
        }
        .reject-btn {
            background-color: #f8f9fa;
            color: #dc3545;
            border: 1px solid #dc3545;
        }
       
        .post-agreement-actions .action-btn-small svg { 
            width: 1em;
            height: 1em;
            fill: currentColor;
        }
        .post-agreement-actions .checkbox-option {
            display: inline-flex;
            align-items: center;
            font-size: 14px;
        }
        .post-agreement-actions .checkbox-option input[type="checkbox"] {
            margin-right: 5px;
        }

        .additional-info {
            text-align: left;
            font-size: 14px;
            color: #555;
            margin-top: 25px;
            padding: 15px;
            border-top: 1px solid #eee;
        }
        .additional-info p {
            margin: 8px 0;
        }

        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); align-items: center; justify-content: center; }
        .modal-content { background-color: #fff; margin: auto; padding: 25px 30px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); width: 90%; max-width: 500px; position: relative; }
        .modal-header { padding-bottom: 15px; border-bottom: 1px solid #e9ecef; margin-bottom: 20px; }
        .modal-header h2 { margin: 0; font-size: 20px; color: #333; }
        .modal-body .form-group { margin-bottom: 20px; }
        .modal-body label { display: block; font-size: 14px; font-weight: bold; color: #333; margin-bottom: 8px; }
        .modal-body input[type="text"], .modal-body textarea { width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; font-size: 14px; }
        .modal-body textarea { min-height: 100px; resize: vertical; }
        .modal-body .required-label { background-color: #fd7e14; color: white; padding: 2px 6px; font-size: 10px; border-radius: 3px; margin-left: 5px; }
        .modal-footer { padding-top: 20px; border-top: 1px solid #e9ecef; margin-top: 20px; display: flex; justify-content: flex-end; gap: 10px; }
        .modal-footer .btn-secondary { background-color: #f8f9fa; color: #333; border: 1px solid #ced4da; }
        .error-message { display: block; color: #dc3545; font-size: 12px; margin-top: 4px; }
        .input-error { border-color: #dc3545 !important; }
        .agree-modal-body .checkbox-group { margin-bottom: 15px; display: flex; align-items: center; }
        .agree-modal-body input[type="checkbox"] { margin-right: 10px; transform: scale(1.1); }
        .agree-modal-body .helper-link { font-size: 13px; color: #007bff; text-decoration: none; display: block; margin-top: 5px; }

        /* --- Styles from renewal_contract_format.html (Merged) --- */
        *, *::before, *::after {
            box-sizing: border-box;
        }
        /* Styles specific to the embedded contract content */
        .embedded-contract-container { 
            max-width: 800px; 
            margin: 0 auto; 
            background-color: #fff;
        }
        .embedded-contract-container h1 {
            text-align: center;
            font-size: 1.6em; 
            margin-bottom: 25px;
            color: #111;
            font-weight: bold;
        }
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
        .header-top .employee-id {
            font-weight: bold;
        }
        .header-top .department-info {
            text-align: center;
            font-size: 0.85em;
            flex-grow: 1;
            margin: 0 10px;
        }
        .header-top .document-meta {
            text-align: right;
        }
        .logo-placeholder {
            border: 2px solid #007bff;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4em;
            font-weight: bold;
            color: #007bff;
            margin-left: auto;
        }
        .employee-name-header {
            text-align: right;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
        }
        .section {
            margin-bottom: 20px;
        }
        .section p {
            margin-bottom: 10px;
        }
        .data-table {
            border: 1px solid #ccc;
        }
        .data-row {
            display: flex; 
            border-bottom: 1px solid #ccc;
        }
        .data-row:last-child {
            border-bottom: none;
        }
        .data-label {
            background-color: #f9f9f9;
            font-weight: bold;
            padding: 10px;
            border-right: 1px solid #ccc; 
            flex-basis: 130px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            overflow-wrap: break-word;
            word-break: break-word; 
        }
        .data-value {
            padding: 10px 15px; 
            flex-grow: 1; 
            overflow-wrap: break-word; 
            word-break: break-word;   
            min-width: 0; 
        }
        .data-value .sub-value {
            margin-bottom: 5px;
        }
        .data-value .sub-value:last-child {
            margin-bottom: 0;
        }
        .data-value .notes {
            font-size: 0.85em;
            color: #555;
            margin-top: 5px;
            overflow-wrap: break-word;
            word-break: break-word;
        }
        .data-value .highlight {
            font-size: 1.1em;
            font-weight: bold;
            margin: 0 5px;
        }
        .office-cd {
            border: 1px solid #ccc;
            padding: 2px 8px;
            margin: 0 8px;
            font-weight: bold;
            background-color: #f0f0f0;
            border-radius: 3px;
            display: inline-block;
        }
        .time-info-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center; 
            flex-wrap: wrap; 
        }
        .time-info-wrapper > span { 
            min-width: 0; 
        }
        .checkbox-item {
            display: flex;
            align-items: flex-start; 
            margin-bottom: 3px;
        }
        .checkbox-symbol {
            font-size: 1.2em;
            margin-right: 8px;
            /* Using more compatible checkbox characters */
            /* font-family: "Segoe UI Symbol", sans-serif; */
            flex-shrink: 0; 
            margin-top: 1px; 
        }
        .checkbox-text {
            flex-grow: 1;
            min-width: 0; 
            overflow-wrap: break-word;
            word-break: break-word;
        }
        .bonus-months {
            margin-left: 0.5em; /* Added space before (4カ月) */
            color: #333;
            white-space: nowrap; 
        }
        .currency-field {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .currency-field .currency-amount, .currency-field .currency-symbol {
             min-width: 0; 
        }
        .signature-section {
            margin-top: 30px;
        }
        .signature-blocks {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-top: 20px; 
        }
        .signature-block {
            width: 48%; 
            margin-bottom: 15px;
        }
        .signature-block .block-title {
            font-size: 0.9em;
            color: #555;
        }
        .signature-block .company-name {
            font-size: 1.1em;
        }
        .signature-block .company-name-large {
            font-size: 1.3em;
            font-weight: bold;
            margin: 5px 0;
        }
        .signature-block .representative {
            margin-top: 10px;
            display: flex;
            align-items: center;
        }
        .signature-block .representative-name {
            font-size: 1.2em;
            font-weight: bold;
            margin-left: 10px;
        }
        .company-seal-img {
            width: 60px; 
            height: 60px;
            vertical-align: middle;
            margin-left: 15px;
        }
        .signature-block .field {
            margin-top: 5px;
            font-weight: bold;
        }
        .signature-block .input-line { 
            border-bottom: 1px solid #333;
            min-height: 25px; 
            margin-top: 5px;
            padding: 2px 0; 
            position: relative;
            font-weight: bold; /* Changed to bold for agreed values */
            font-size: 1.6em;    /* Increased font size for agreed values */
            line-height: 1.2; /* Adjusted line-height for larger font */
            word-break: break-all; /* Allow long names/dates to break */
        }
        .signature-block .input-line#agreement-datetime-field,
        .signature-block .input-line#employee-signature-field {
             min-height: 40px; /* Ensure enough height for larger font */
        }

        .signature-block .seal-placeholder {
            position: absolute;
            right: 5px;
            bottom: 0;
            font-size: 0.9em; /* Seal placeholder remains normal size */
            font-weight: normal; /* Seal placeholder remains normal weight */
        }
        .responsible-person-section {
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 20px;
            display: flex;
            align-items: center; 
            flex-wrap: nowrap; 
        }
        .responsible-person-section .title {
            font-weight: bold;
            margin-right: 10px; 
            white-space: nowrap; 
            flex-shrink: 0;
        }
        .responsible-person-section .role {
            border: 1px solid #ccc;
            padding: 5px 10px; 
            text-align: center;
            margin-right: 10px;
            font-size: 0.9em;
            white-space: nowrap; 
        }
        .responsible-person-section .role:last-child {
            margin-right: 0;
        }
        .manager-name { 
            display: inline; 
            font-weight: normal;
            font-size: 1em;
            margin-left: 5px; 
        }
        .footer-info {
            margin-top: 25px;
            font-size: 0.85em;
            color: #555;
        }
        
        @media (max-width: 600px) {
            .main-content {
                padding: 15px;
            }
            .title-and-actions-row {
                flex-direction: column; 
                align-items: center; 
            }
            .page-main-title-wrapper {
                justify-content: center; 
                width: 100%;
                margin-bottom: 10px; 
                text-align: center; /* Ensure h1 and status indicator are centered */
            }
             .main-content h1 {
                white-space: normal; /* Allow title to wrap on small screens */
            }
            #agreement-status-indicator {
                font-size: 1.5em; /* Adjust for smaller screens */
            }
            .post-agreement-actions {
                margin-left: 0; 
                align-items: center; 
                width: 100%;
            }
            .action-buttons-row-inner {
                justify-content: center; 
                width: 100%;
            }
            .post-agreement-actions .action-btn-small {
                 width: 45%; 
            }
            .contract-viewer {
                 padding: 10px;
            }
            .embedded-contract-container h1 {
                font-size: 1.3em;
            }
            .data-row {
                flex-direction: column; 
            }
            .data-label {
                border-right: none; 
                border-bottom: 1px solid #ccc; 
                flex-basis: auto; 
                width: 100%; 
                justify-content: flex-start; 
            }
            .data-value {
                width: 100%; 
            }
            .time-info-wrapper {
                flex-direction: column;
                align-items: flex-start; 
            }
            .time-info-wrapper > span {
                width: 100%; 
                margin-bottom: 5px; 
            }
            .time-info-wrapper > span:last-child {
                margin-bottom: 0;
            }
            .currency-field {
                flex-direction: column;
                align-items: flex-start; 
            }
            .currency-field .currency-amount {
                margin-bottom: 3px; 
            }
            .signature-blocks {
                flex-direction: column;
            }
            .signature-block {
                width: 100%; 
            }
             .signature-block .input-line {
                font-size: 1.5em; /* Adjust agreed value font for small screens */
            }
            .responsible-person-section {
                flex-direction: column; 
                align-items: flex-start;
            }
            .responsible-person-section .title {
                margin-bottom: 5px; 
            }
            .responsible-person-section .role {
                margin-right: 0;
                margin-bottom: 5px;
                width: auto; 
            }
             .manager-name {
                display: block; 
                margin-left: 0;
                margin-top: 3px;
            }
            .header-top { 
                flex-direction: column;
                align-items: flex-start;
            }
            .header-top .department-info, .header-top .document-meta {
                text-align: left;
                margin-top: 10px;
            }
            .logo-placeholder {
                 margin-left: 0;
            }
        }
    </style>
</head>
<body>

    <header class="page-header">
        <div class="breadcrumb">
            <span id="employee-info-header">000000 ななし ごんべえ</span> さん (労働条件通知書 兼 雇用契約書)
        </div>
        <a href="index.html" class="logout-button">ログアウト</a>
    </header>

    <div class="debug-controls">
        <button id="reset-storage-btn">テストデータリセット (LocalStorageクリア & 再読込)</button>
    </div>

    <main class="main-content">
        <div class="page-title-container">
            <div class="title-and-actions-row">
                <div class="page-main-title-wrapper">
                    <h1>労働条件通知書 兼 雇用契約書</h1>
                    <span id="agreement-status-indicator">（合意済み）</span>
                </div>
                <div class="post-agreement-actions" id="post-agreement-actions">
                    <div class="action-buttons-row-inner"> 
                        <button type="button" class="action-btn-small" id="print-btn">
                            <svg viewBox="0 0 20 20"><path d="M16 10c0 .55-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1h10c.55 0 1 .45 1 1zM5 13h4c.55 0 1 .45 1 1s-.45 1-1 1H5c-.55 0-1-.45-1-1s.45-1 1-1zm12-8H3c-.55 0-1 .45-1 1v2H1c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1h18c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1zm-1 10H2V7h1V4h14v9zM6 2h8v2H6V2z"/></svg>
                            印刷
                        </button>
                        <button type="button" class="action-btn-small" id="download-btn">
                            <svg viewBox="0 0 20 20"><path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/></svg>
                            ダウンロード
                        </button>
                    </div>
                    <span class="checkbox-option">
                        <input type="checkbox" id="show-agreement-mark" checked>
                        <label for="show-agreement-mark">合意マークを表示する</label>
                    </span>
                </div>
            </div>
            <p class="post-agreement-note-standalone" id="main-post-agreement-note">※書類が正しく表示されない場合は、PDFファイルをダウンロードして確認してください。</p>
        </div>

        <div class="info-banner">
            就労条件に関する内容を含む書類です。
        </div>

        <div class="contract-viewer" id="contract-display-area">
            <!-- EMBEDDED CONTRACT CONTENT STARTS HERE -->
            <div class="embedded-contract-container">
                <div class="header-top">
                    <div>
                        <div class="employee-id">社員番号：378943</div>
                    </div>
                    <div class="department-info">
                        <div>首都圏B1第二事業本部</div>
                        <div>殿 東京B1第4事業部(榎本 淳)</div>
                    </div>
                    <div class="document-meta">
                        <div class="logo-placeholder">サ</div>
                    </div>
                </div>

                <div class="employee-name-header">剛腕怜王 殿</div> <!-- Changed Name -->

                <h1>サプラー 雇用契約書 兼 労働条件確認書</h1>

                <div class="section">
                    <p>株式会社 LEOC と 剛腕怜王 は、下記の通り雇用契約を締結する。</p> <!-- Changed Name -->
                </div>

                <div class="data-table">
                    <div class="data-row">
                        <div class="data-label">雇用区分</div>
                        <div class="data-value">サプラー</div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">雇用期間</div>
                        <div class="data-value">2024年 12月 1日 から 2025年 9月 30日 まで</div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">勤務地</div>
                        <div class="data-value">
                            <div class="sub-value">
                                事業所名 <span class="office-cd">314485</span> みずほ銀行清瀬
                            </div>
                            <div class="notes">業務上の必要に応じて勤務地を変更することがあります。</div>
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">業務内容</div>
                        <div class="data-value">調理および付随業務全般 ・ その他 (　　　　　　　　)</div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">所定<br>労働時間</div>
                        <div class="data-value">
                            <div class="sub-value time-info-wrapper">
                                <span>契約時間<span class="highlight">4</span>時間</span>
                                <span>週あたり<br>労働時間<span class="highlight">7.4</span>時間</span>
                            </div>
                            <div class="notes">※1日あたりの平均的な実働時間 (フルタイムの場合は8時間)</div>
                            <div class="sub-value" style="margin-top: 5px;">契約日数<span class="highlight">8</span>日</div>
                            <div class="notes">※1ヶ月あたりの平均的な勤務日数 (フルタイムの場合は22日)</div>
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">基本的な<br>勤務パターン</div>
                        <div class="data-value">
                            <div class="sub-value">1. <span style="margin: 0 5px;">　</span>時<span style="margin: 0 5px;">　</span>分～<span style="margin: 0 5px;">　</span>時<span style="margin: 0 5px;">　</span>分 (内休憩<span style="margin: 0 5px;">　</span>分)</div>
                            <div class="sub-value">2. <span style="margin: 0 5px;">　</span>時<span style="margin: 0 5px;">　</span>分～<span style="margin: 0 5px;">　</span>時<span style="margin: 0 5px;">　</span>分 (内休憩<span style="margin: 0 5px;">　</span>分)</div>
                            <div class="notes">この時間帯を基本とし、シフト表により指示します。(変形労働時間制)</div>
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">給与</div>
                        <div class="data-value">
                            <div class="sub-value currency-field">
                                <span class="currency-amount">時間給<span class="highlight">1,163</span>円</span>
                                <span class="currency-symbol">：<span style="margin: 0 10px;">　</span>円</span>
                            </div>
                            <div class="sub-value currency-field">
                                <span class="currency-amount">月あたり給与見込み<span class="highlight">37,216</span>円</span>
                                <span class="currency-symbol">：<span style="margin: 0 10px;">　</span>円</span>
                            </div>
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">賞与</div>
                        <div class="data-value">
                            <div class="checkbox-item">
                                <span class="checkbox-symbol">□</span><span class="checkbox-text">あり</span><span class="bonus-months">(4カ月)</span> <!-- Adjusted spacing and checkbox char -->
                            </div>
                            <div class="checkbox-item">
                                <span class="checkbox-symbol">✔</span><span class="checkbox-text">なし</span> <!-- Adjusted checkbox char -->
                            </div>
                            <div class="notes">会社の業績等の要因により不支給となることがあります。</div>
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">次回更新</div>
                        <div class="data-value">
                            <div class="checkbox-item">
                                <span class="checkbox-symbol">✔</span> <!-- Adjusted checkbox char -->
                                <span class="checkbox-text">契約満了時の業務量、勤務成績、態度、能力、経営状況等により判断いたします。</span>
                            </div>
                            <div class="checkbox-item">
                                <span class="checkbox-symbol">□</span> <!-- Adjusted checkbox char -->
                                <span class="checkbox-text">今回の契約更新を最後といたします。</span>
                            </div>
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">社会保険</div>
                        <div class="data-value">
                            <div class="checkbox-item">
                                <span class="checkbox-symbol">□</span> <!-- Adjusted checkbox char -->
                                <span class="checkbox-text">A.健康保険・厚生年金・雇用保険の全てに加入</span>
                            </div>
                            <div class="checkbox-item">
                                <span class="checkbox-symbol">✔</span> <!-- Adjusted checkbox char -->
                                <span class="checkbox-text">B.雇用保険のみ加入</span>
                            </div>
                            <div class="checkbox-item">
                                <span class="checkbox-symbol">□</span> <!-- Adjusted checkbox char -->
                                <span class="checkbox-text">C.いずれにも加入しない</span>
                            </div>
                            <div class="notes" style="border: 1px solid #ddd; padding: 8px; margin-top: 8px; background-color: #f9f9f9;">
                                契約条件が法定の要件を満たした場合には、健康保険・厚生年金・雇用保険に加入いただきます。<br>
                                週20時間以上は雇用保険加入／ 週20時間以上かつ月あたり給与見込み 88,000円以上は全ての社会保険に加入
                            </div>
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">休日</div>
                        <div class="data-value">契約日数に基づき、月次シフト表により指示します。</div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">有給休暇</div>
                        <div class="data-value">
                            入社から6ヶ月間、契約日数の8割以上勤務した場合に初回付与します。付与日数は契約日数によって異なります。<br>
                            2回目は入社より1年6ヶ月後、以降毎年4月1日に就業規則に定める基準を満たした場合に付与します。
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">給与改定</div>
                        <div class="data-value">
                            次回契約更新時に個人の評価、会社業績等により見直しを行う場合があります。今回の契約期間中に給与を改定する場合は、別途変更雇用契約書を作成することとします。
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">その他</div>
                        <div class="data-value">
                            1.月度における勤務日数、時間については業務の状況により変動することがあります。<br>
                            2.所定外労働・休日労働をさせることがあります。<br>
                            3.賃金は毎月末日締めとし、翌月20日に被用者本人の指定口座に振り込みます。<br>
                            4.退職及び解雇の基準は就業規則に準じます。<br>
                            5.上記に記載されていないほかの就労条件等は、就業規則に準じます。
                        </div>
                    </div>
                    <div class="data-row">
                        <div class="data-label">備考</div>
                        <div class="data-value" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                            <span>別紙の注意事項もご確認ください。</span>
                        </div>
                    </div>
                </div>

                <div class="section" style="margin-top: 25px;">
                    <p>使用者と被用者間において、上記の通り雇用契約を締結し、互いに誠実にこれを履行する。</p>
                </div>

                <div class="signature-section">
                    <div class="signature-blocks">
                        <div class="signature-block">
                            <div class="block-title">使用者<br>(会社)</div>
                            <div class="company-name">ONODERA GROUP</div>
                            <div class="company-name-large">株式会社 LEOC</div>
                            <div class="representative">
                                代表取締役
                                <span class="representative-name">田島 利行</span>
                                <img src="./leoc_stamp.png" alt="社印" class="company-seal-img" onerror="this.style.display='none'"> <!-- Updated src -->
                            </div>
                        </div>
                        <div class="signature-block">
                            <div class="block-title">被用者<br>(本人)</div>
                            <div class="field">合意日時</div>
                            <div class="input-line" id="agreement-datetime-field" aria-label="合意日時表示欄"></div>
                            
                            <div class="field" style="margin-top: 10px;">氏名</div>
                            <div class="input-line" id="employee-signature-field" aria-label="氏名表示欄">
                                <span class="seal-placeholder">印</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="responsible-person-section">
                    <div class="title">契約責任者</div> 
                    <div class="role">上長<span class="manager-name">山田 太郎</span></div>
                </div>

                <div class="footer-info">
                    <div>(2024/10 時点) 4時間×12日 社保：非加入 雇保：非加入</div>
                    <div>入社年月日：2023/10/11</div>
                </div>
            </div>
            <!-- EMBEDDED CONTRACT CONTENT ENDS HERE -->
        </div>

        <p class="action-prompt" id="pre-agreement-prompt">書類を確認のうえ、「合意に進む」を押してください。</p>
        <div class="button-group" id="pre-agreement-buttons">
            <button type="button" class="action-btn reject-btn" id="open-reject-modal-btn">差し戻す</button>
            <button type="button" class="action-btn agree-btn" id="open-agree-modal-btn">合意に進む</button>
        </div>

        <div class="additional-info">
            <p>電子通知希望の有無：<span id="delivery-preference-status">（未設定）</span></p>
            <p>電子通知の受領確認：<span id="receipt-confirmation-status">未</span></p>
        </div>
    </main>

    <!-- Modals (unchanged) -->
    <div id="agree-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>書類の合意</h2></div>
            <div class="modal-body agree-modal-body">
                <p style="font-size:14px; margin-bottom:15px;">ご自身の氏名を入力し、書類の受け取り方法にチェックを入れて、「合意」を押してください。書類の合意が完了します。</p>
                <form id="agree-form">
                    <div class="form-group">
                        <label for="signer-name">署名<span class="required-label">必須</span></label>
                        <input type="text" id="signer-name" name="signer_name" placeholder="入力例: 怜王 クニオ">
                        <span class="error-message" id="signer-name-error"></span>
                    </div>
                    <div class="form-group">
                        <label>書類の受け取り方法<span class="required-label">必須</span></label>
                        <div class="checkbox-group">
                            <input type="checkbox" id="agree-electronic-delivery" name="agree_electronic_delivery" checked>
                            <label for="agree-electronic-delivery">電子通知で受け取ることに同意する</label>
                        </div>
                        <a href="#" class="helper-link" id="change-delivery-method-link">書類の受け取り方法を選択しなおす場合はこちら →</a>
                         <span class="error-message" id="agree-delivery-error"></span>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="action-btn btn-secondary" id="cancel-agree-btn">キャンセル</button>
                <button type="button" class="action-btn agree-btn" id="submit-agree-btn">合意</button>
            </div>
        </div>
    </div>
    <div id="reject-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>依頼を差し戻す</h2></div>
            <div class="modal-body">
                <form id="reject-form">
                    <div class="form-group">
                        <label for="reject-reason">理由<span class="required-label">必須</span></label>
                        <textarea id="reject-reason" name="reject_reason" placeholder="差し戻しの理由を入力します"></textarea>
                        <span class="error-message" id="reject-reason-error"></span>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="action-btn btn-secondary" id="cancel-reject-btn">キャンセル</button>
                <button type="button" class="action-btn reject-btn" style="background-color:#dc3545; color:white;" id="submit-reject-btn">差し戻す</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log("DOM fully loaded and parsed");
            const agreeModal = document.getElementById('agree-modal');
            const rejectModal = document.getElementById('reject-modal');
            const openAgreeModalBtn = document.getElementById('open-agree-modal-btn');
            const openRejectModalBtn = document.getElementById('open-reject-modal-btn');
            
            if (!agreeModal) console.error("Agree Modal element NOT FOUND (id: agree-modal)");
            else console.log("Agree Modal element found:", agreeModal);

            if (!rejectModal) console.error("Reject Modal element NOT FOUND (id: reject-modal)");
            else console.log("Reject Modal element found:", rejectModal);

            if (!openAgreeModalBtn) console.error("Open Agree Modal Button element NOT FOUND (id: open-agree-modal-btn)");
            else console.log("Open Agree Modal Button element found:", openAgreeModalBtn);

            if (!openRejectModalBtn) console.error("Open Reject Modal Button element NOT FOUND (id: open-reject-modal-btn)");
            else console.log("Open Reject Modal Button element found:", openRejectModalBtn);


            const cancelAgreeBtn = document.getElementById('cancel-agree-btn');
            const cancelRejectBtn = document.getElementById('cancel-reject-btn');
            const submitAgreeBtn = document.getElementById('submit-agree-btn');
            const submitRejectBtn = document.getElementById('submit-reject-btn');
            const signerNameInput = document.getElementById('signer-name');
            const agreeElectronicDeliveryCheckbox = document.getElementById('agree-electronic-delivery');
            const signerNameError = document.getElementById('signer-name-error');
            const agreeDeliveryError = document.getElementById('agree-delivery-error');
            const changeDeliveryMethodLink = document.getElementById('change-delivery-method-link');
            const rejectReasonInput = document.getElementById('reject-reason');
            const rejectReasonError = document.getElementById('reject-reason-error');
            
            const agreementStatusIndicator = document.getElementById('agreement-status-indicator');

            const deliveryPreferenceStatusSpan = document.getElementById('delivery-preference-status');
            const receiptConfirmationStatusSpan = document.getElementById('receipt-confirmation-status');
            const preAgreementPrompt = document.getElementById('pre-agreement-prompt');
            const preAgreementButtons = document.getElementById('pre-agreement-buttons');
            const postAgreementActions = document.getElementById('post-agreement-actions');
            const mainPostAgreementNote = document.getElementById('main-post-agreement-note');
            const printBtn = document.getElementById('print-btn');
            const downloadBtn = document.getElementById('download-btn');
            const showAgreementMarkCheckbox = document.getElementById('show-agreement-mark');
            const resetStorageBtn = document.getElementById('reset-storage-btn');

            const DELIVERY_PREFERENCE_KEY = 'deliveryPreference'; 
            const AGREEMENT_STATUS_KEY = 'agreementStatus';
            const SIGNER_NAME_KEY = 'signerName';
            const AGREEMENT_DATETIME_KEY = 'agreementDateTime';

            function openModal(modal) { 
                if (!modal) {
                    console.error("openModal was called with a null or undefined modal. Cannot display.");
                    return;
                }
                console.log("Attempting to open modal:", modal.id);
                modal.style.display = 'flex'; 
                console.log("Modal display style set to 'flex' for:", modal.id);
            }
            
            function closeModal(modal) {
                if (!modal) {
                    console.error("closeModal was called with a null or undefined modal.");
                    return;
                }
                console.log("Closing modal:", modal.id);
                modal.style.display = 'none';
                if (modal === agreeModal) {
                    signerNameInput.classList.remove('input-error');
                    signerNameError.textContent = '';
                    agreeDeliveryError.textContent = '';
                } else if (modal === rejectModal) {
                    rejectReasonInput.classList.remove('input-error');
                    rejectReasonError.textContent = '';
                }
                window.scrollTo(0, 0); 
            }

            function populateContractContent(name, dateTime) { 
                console.log("Inside populateContractContent. Name: " + name + ", DateTime: " + dateTime);
                const nameFieldInContract = document.getElementById('employee-signature-field');
                if (nameFieldInContract) {
                    nameFieldInContract.textContent = name ? name : '';
                } else {
                    console.error("Could NOT find 'employee-signature-field' in document.");
                }

                const dateTimeFieldInContract = document.getElementById('agreement-datetime-field');
                if (dateTimeFieldInContract) {
                    dateTimeFieldInContract.textContent = dateTime ? dateTime : '';
                } else {
                    console.error("Could NOT find 'agreement-datetime-field' in document.");
                }
            }

            function updateAgreementStatusDisplay(isAgreed) {
                if (agreementStatusIndicator) {
                    agreementStatusIndicator.style.display = isAgreed ? 'inline' : 'none';
                }
            }

            function loadAdditionalInfo() {
                console.log("loadAdditionalInfo called");
                const preference = localStorage.getItem(DELIVERY_PREFERENCE_KEY);
                deliveryPreferenceStatusSpan.textContent = (preference === 'electronic') ? '有' : (preference === 'paper') ? '書面で受取り' : '（未設定）';
                
                const isAgreed = localStorage.getItem(AGREEMENT_STATUS_KEY) === 'agreed';
                console.log("Is agreed (from localStorage)? " + isAgreed);
                updateAgreementStatusDisplay(isAgreed);

                if (isAgreed) {
                    receiptConfirmationStatusSpan.textContent = '済';
                    if(preAgreementPrompt) preAgreementPrompt.style.display = 'none';
                    if(preAgreementButtons) preAgreementButtons.style.display = 'none';
                    if(postAgreementActions) postAgreementActions.style.display = 'flex';
                    if (mainPostAgreementNote) mainPostAgreementNote.style.display = 'block';

                    const storedSignerName = localStorage.getItem(SIGNER_NAME_KEY);
                    const storedAgreementDateTime = localStorage.getItem(AGREEMENT_DATETIME_KEY);
                    populateContractContent(storedSignerName, storedAgreementDateTime); 
                } else {
                    receiptConfirmationStatusSpan.textContent = '未';
                    if(preAgreementPrompt) preAgreementPrompt.style.display = 'block';
                    if(preAgreementButtons) preAgreementButtons.style.display = 'flex';
                    if(postAgreementActions) postAgreementActions.style.display = 'none';
                    if (mainPostAgreementNote) mainPostAgreementNote.style.display = 'none';
                    populateContractContent('', ''); 
                }
            }
            loadAdditionalInfo(); 

            if (openAgreeModalBtn) {
                openAgreeModalBtn.addEventListener('click', () => {
                    console.log("'Open Agree Modal' button clicked.");
                    if (agreeModal) {
                        openModal(agreeModal);
                    } else {
                        console.error("Cannot open agree modal: agreeModal element is null at click time.");
                    }
                });
            }
            
            if (openRejectModalBtn) {
                openRejectModalBtn.addEventListener('click', () => {
                    console.log("'Open Reject Modal' button clicked.");
                    if (rejectModal) {
                        openModal(rejectModal);
                    } else {
                        console.error("Cannot open reject modal: rejectModal element is null at click time.");
                    }
                });
            }

            if (cancelAgreeBtn) cancelAgreeBtn.addEventListener('click', () => closeModal(agreeModal));
            if (cancelRejectBtn) cancelRejectBtn.addEventListener('click', () => closeModal(rejectModal));
            
            window.addEventListener('click', (event) => {
                if (event.target === agreeModal) closeModal(agreeModal);
                if (event.target === rejectModal) closeModal(rejectModal);
            });

            if (changeDeliveryMethodLink) {
                changeDeliveryMethodLink.addEventListener('click', function(e){
                    e.preventDefault();
                    console.log('書類の受け取り方法選択ページに遷移します。（現在のページの状態は保存されません）');
                });
            }

            if (submitAgreeBtn) {
                submitAgreeBtn.addEventListener('click', function() {
                    console.log("Submit Agree Button Clicked");
                    let isValid = true;
                    signerNameInput.classList.remove('input-error');
                    signerNameError.textContent = '';
                    agreeDeliveryError.textContent = '';

                    if (signerNameInput.value.trim() === '') {
                        signerNameInput.classList.add('input-error');
                        signerNameError.textContent = '氏名を入力してください。';
                        isValid = false;
                    }
                    if (!agreeElectronicDeliveryCheckbox.checked) {
                        agreeDeliveryError.textContent = '書類の受け取り方法に同意してください。';
                        isValid = false;
                    }

                    if (isValid) {
                        console.log('書類に合意しました。');
                        
                        const signerName = signerNameInput.value.trim();
                        const now = new Date();
                        const year = now.getFullYear();
                        const month = (now.getMonth() + 1).toString().padStart(2, '0');
                        const day = now.getDate().toString().padStart(2, '0');
                        const hours = now.getHours().toString().padStart(2, '0');
                        const minutes = now.getMinutes().toString().padStart(2, '0');
                        const seconds = now.getSeconds().toString().padStart(2, '0');
                        const agreementDateTime = `${year}年${month}月${day}日 ${hours}時${minutes}分${seconds}秒`;
                        
                        populateContractContent(signerName, agreementDateTime); 
                        updateAgreementStatusDisplay(true);
                        
                        receiptConfirmationStatusSpan.textContent = '済';
                        if(preAgreementPrompt) preAgreementPrompt.style.display = 'none';
                        if(preAgreementButtons) preAgreementButtons.style.display = 'none';
                        if(postAgreementActions) postAgreementActions.style.display = 'flex'; 
                        if (mainPostAgreementNote) mainPostAgreementNote.style.display = 'block';

                        localStorage.setItem(AGREEMENT_STATUS_KEY, 'agreed'); 
                        localStorage.setItem(SIGNER_NAME_KEY, signerName);
                        localStorage.setItem(AGREEMENT_DATETIME_KEY, agreementDateTime);
                        
                        closeModal(agreeModal);
                    }
                });
            } else {
                console.error("submitAgreeBtn not found!");
            }

            if (submitRejectBtn) {
                submitRejectBtn.addEventListener('click', function() {
                    console.log("Submit Reject Button Clicked"); 
                    let isValid = true;
                    rejectReasonInput.classList.remove('input-error');
                    rejectReasonError.textContent = '';
                    if (rejectReasonInput.value.trim() === '') {
                        rejectReasonInput.classList.add('input-error');
                        rejectReasonError.textContent = '差し戻し理由を入力してください。';
                        isValid = false;
                    }
                    if (isValid) {
                        console.log('書類を差し戻しました。');
                        localStorage.removeItem(AGREEMENT_STATUS_KEY);
                        localStorage.removeItem(SIGNER_NAME_KEY);
                        localStorage.removeItem(AGREEMENT_DATETIME_KEY);
                        loadAdditionalInfo(); 
                        closeModal(rejectModal);
                    }
                });
            }

            [signerNameInput, rejectReasonInput].forEach(input => {
                if (input) {
                    input.addEventListener('input', function() {
                        if (this.classList.contains('input-error')) {
                            this.classList.remove('input-error');
                            if (this.id === 'signer-name') signerNameError.textContent = '';
                            if (this.id === 'reject-reason') rejectReasonError.textContent = '';
                        }
                    });
                }
            });

            if (agreeElectronicDeliveryCheckbox) {
                agreeElectronicDeliveryCheckbox.addEventListener('change', function(){
                    if(this.checked){
                        agreeDeliveryError.textContent = '';
                    }
                });
            }

            if (printBtn) {
                printBtn.addEventListener('click', function() { 
                    console.log("Print button clicked.");
                    window.print(); 
                });
            }

            if (downloadBtn) downloadBtn.addEventListener('click', function() { console.log('ダウンロード処理を実行します。（ダミー）'); });
            if (showAgreementMarkCheckbox) {
                showAgreementMarkCheckbox.addEventListener('change', function() {
                    console.log(this.checked ? '合意マークを表示します。（ダミー）' : '合意マークを非表示にします。（ダミー）');
                });
            }

            if(resetStorageBtn) {
                resetStorageBtn.addEventListener('click', function() {
                    console.log("Reset storage button clicked"); 
                    localStorage.removeItem(DELIVERY_PREFERENCE_KEY);
                    localStorage.removeItem(AGREEMENT_STATUS_KEY);
                    localStorage.removeItem(SIGNER_NAME_KEY);
                    localStorage.removeItem(AGREEMENT_DATETIME_KEY);
                    updateAgreementStatusDisplay(false);
                    populateContractContent('', ''); 
                    window.location.reload(); 
                });
            }
        });
    </script>

</body>
</html>
